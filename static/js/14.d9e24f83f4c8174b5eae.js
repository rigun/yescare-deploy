webpackJsonp([14],{116:function(a,t,e){"use strict";t.a={mounted:function(){this.$parent.tab="branchD4",this.getData()},data:function(){return{displayTotal:0,totalHarga:0,dialogNotaLunas:!1,montir:[],layanans:[],errorLayanan:"",subtotalLayanan:0,spareparts:[],load:!1,valid:!0,search:"",transaction:{customer:"",cs:{name:""}},detailTransactions:[],detailTransactionsLayanan:[],detailTransactionsSparepart:[],snackbar:!1,text:"",color:null,reset:!1,loading:!1,loadDataSparepart:!0,loadDataLayanan:!0,isPaginated:!0,isPaginationSimple:!0,defaultSortDirection:"desc",currentPage:1,perPage:10,subtotal:0,editData:{diskon:0,payment:0},uniqueMontir:[],biayaMinDiskon:0,displayBiayaMinDiskon:0,displayKembalian:0,changeError:""}},computed:{detailTransactionsSparepartList:function(){var a=this;if(this.detailTransactionsSparepart.length)return this.detailTransactionsSparepart.filter(function(t,e){return""===a.search||(t.detail.name.toLowerCase().includes(a.search.toLowerCase())||t.detail.user.email.toLowerCase().includes(a.search.toLowerCase())||t.detail.phoneNumber.toLowerCase().includes(a.search.toLowerCase()))})},detailTransactionsLayananList:function(){var a=this;if(this.detailTransactionsLayanan.length)return this.detailTransactionsLayanan.filter(function(t,e){return""===a.search||(t.detail.name.toLowerCase().includes(a.search.toLowerCase())||t.detail.user.email.toLowerCase().includes(a.search.toLowerCase())||t.detail.phoneNumber.toLowerCase().includes(a.search.toLowerCase()))})}},methods:{countDiskon:function(){this.biayaMinDiskon=this.totalHarga-this.editData.diskon,this.displayBiayaMinDiskon=this.price(this.biayaMinDiskon)},countChange:function(){this.editData.kembalian=this.editData.payment-this.biayaMinDiskon,this.displayKembalian=this.price(this.editData.kembalian),this.editData.kembalian<0?this.changeError="Total bayar masih kurang":this.changeError=""},montirdetailTransactions:function(){for(var a=this,t=[],e=0;e<this.detailTransactions.length;e++){t.filter(function(t,i){return t.montir_id!==a.detailTransactions[e].montir_id}).length===t.length&&t.push(this.detailTransactions[e])}this.uniqueMontir=t},cetakNotaLunas:function(){var a=this;if(!this.$refs.form.validate())return this.snackbar=!0,this.text="Mohon untuk melengkapi form yang tersedia",void(this.color="error");if(""!==this.changeError)return this.snackbar=!0,this.text="Mohon maaf, pembayaran masih kurang",void(this.color="error");this.load=!0;var t={responseType:"blob",headers:{Authorization:"Bearer "+localStorage.getItem("token")}};this.editData.totalServices=this.TotalService(),this.editData.totalSpareparts=this.TotalSparepart();var e=this.$apiUrl+"notaLunas/"+this.$route.params.idTransaction;this.$http.post(e,this.editData,t).then(function(t){var e=window.URL.createObjectURL(new Blob([t.data])),i=document.createElement("a");i.href=e,i.setAttribute("download","spk_"+a.$route.params.transactionType+"-"+a.$route.params.transactionNumber+"-"+a.$route.params.idTransaction+".pdf"),document.body.appendChild(i),i.click(),a.load=!1,a.dialogNotaLunas=!1}).catch(function(t){console.log(t.response),a.load=!1,a.snackbar=!0,a.color="error",a.text="Coba lagi"})},price:function(a){return new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:2}).format(a)},TotalSparepart:function(){for(var a=0,t=0;t<this.detailTransactionsSparepart.length;t++)a+=this.detailTransactionsSparepart[t].data.total*this.detailTransactionsSparepart[t].data.price;return a},TotalService:function(){for(var a=0,t=0;t<this.detailTransactionsLayanan.length;t++)a+=this.detailTransactionsLayanan[t].total*this.detailTransactionsLayanan[t].price;return a},getData:function(){var a=this;this.load=!1;var t={headers:{Authorization:"Bearer "+localStorage.getItem("token")}},e=this.$apiUrl+"mytransaction/"+this.$route.params.idTransaction;this.$http.get(e,t).then(function(t){a.detailTransactionsLayanan=t.data.service,a.detailTransactionsSparepart=t.data.sparepart,a.detailTransactions=t.data.detailTransaction,a.transaction=t.data.transaction,a.loadDataSparepart=!1,a.loadDataLayanan=!1,a.$nextTick(function(){this.totalHarga=this.TotalService()+this.TotalSparepart(),this.displayTotal=this.price(this.totalHarga),this.montirdetailTransactions()})})}}}},152:function(a,t,e){"use strict";var i=function(){var a=this,t=a.$createElement,e=a._self._c||t;return e("div",{staticClass:"contentlist"},[e("div",{staticClass:"flex-container"},[e("nav",{staticClass:"breadcrumb",attrs:{"aria-label":"breadcrumbs"}},[e("ul",[e("li",[e("router-link",{attrs:{to:{name:"branchD4"}}},[a._v("Pembayaran")])],1),a._v(" "),e("li",{staticClass:"is-active"},[e("a",{attrs:{href:"#"}},[a._v(a._s(a.$route.params.transactionType+"-"+a.$route.params.transactionNumber+"-"+a.$route.params.idTransaction))])])])]),a._v(" "),e("div",{staticClass:"columns m-t-10"},[e("div",{staticClass:"column"},[e("p",{staticClass:"title"},[a._v("Nomor Transaksi: "+a._s(a.transaction.transactionNumber+"-"+a.transaction.id)+" "),e("br"),a._v(" Konsumen: "),e("br"),a._v(" "+a._s(a.transaction.customer.name)+" "),e("br"),a._v(" Telepon: "+a._s(a.transaction.customer.phoneNumber))])]),a._v(" "),e("div",{staticClass:"column"},[e("p",[a._v("CS: "+a._s(a.transaction.cs.name))]),a._v(" "),e("p",[a._v("Montir:")]),a._v(" "),a._l(a.uniqueMontir,function(t){return e("p",{key:t.montir_id},[null!=t.montir_id?e("span",[a._v("- "+a._s(t.montir.name))]):a._e()])}),a._v(" "),e("p",[a._v("Kendaraan:")]),a._v(" "),a._l(a.detailTransactions,function(t){return e("p",{key:t.vehicle_customer.vehicle.id},[e("span",[a._v("- "+a._s(t.vehicle_customer.vehicle.merk+" "+t.vehicle_customer.vehicle.type+" "+t.vehicle_customer.licensePlate))])])})],2),a._v(" "),e("div",{staticClass:"column"},[e("v-flex",{staticStyle:{"margin-left":"auto"},attrs:{sm6:"","d-flex":""}},[e("v-btn",{attrs:{slot:"activator",color:"blue lighten-2",dark:""},on:{click:function(t){t.preventDefault(),a.dialogNotaLunas=!0,a.countDiskon(),a.countChange()}},slot:"activator"},[a._v("Cetak Nota Lunas")])],1)],1)]),a._v(" "),"SV"!=a.$route.params.transactionType?e("div",[a._m(0),a._v(" "),e("nav",{staticClass:"level"},[e("div",{staticClass:"level-left"},[e("b-field",{attrs:{grouped:"","group-multiline":""}},[e("b-select",{attrs:{disabled:!a.isPaginated},model:{value:a.perPage,callback:function(t){a.perPage=t},expression:"perPage"}},[e("option",{attrs:{value:"10"}},[a._v("10 per page")]),a._v(" "),e("option",{attrs:{value:"20"}},[a._v("20 per page")]),a._v(" "),e("option",{attrs:{value:"50"}},[a._v("50 per page")])])],1)],1),a._v(" "),e("div",{staticClass:"level-right"},[e("b-field",[e("b-input",{attrs:{placeholder:"Search...",type:"search",icon:"magnify"},model:{value:a.search,callback:function(t){a.search=t},expression:"search"}})],1)],1)]),a._v(" "),e("b-table",{attrs:{data:a.detailTransactionsSparepartList,paginated:!0,"per-page":a.perPage,"current-page":a.currentPage,loading:a.loadDataSparepart,"pagination-simple":!0,narrowed:!0,"mobile-cards":!0,striped:!0,hoverable:!0},on:{"update:currentPage":function(t){a.currentPage=t},"update:current-page":function(t){a.currentPage=t}},scopedSlots:a._u([{key:"default",fn:function(t){return[e("b-table-column",{attrs:{label:"No.",sortable:""}},[a._v(a._s(t.index+1))]),a._v(" "),e("b-table-column",{attrs:{field:"code",label:"Kode",sortable:""}},[a._v(a._s(t.row.data.sparepart.code))]),a._v(" "),e("b-table-column",{attrs:{field:"name",label:"Nama",sortable:""}},[a._v(a._s(t.row.data.sparepart.name))]),a._v(" "),e("b-table-column",{attrs:{field:"merk",label:"Merk",sortable:""}},[a._v(a._s(t.row.data.sparepart.merk))]),a._v(" "),e("b-table-column",{attrs:{field:"position",label:"Rak",sortable:""}},[a._v(a._s(t.row.position))]),a._v(" "),e("b-table-column",{staticStyle:{"text-align":"right"},attrs:{label:"SubTotal",numeric:""}},[a._v(a._s(a.price(t.row.data.total*t.row.data.price)))])]}}])},[a._v(" "),e("template",{slot:"empty"},[e("section",{staticClass:"section"},[e("div",{staticClass:"content has-text-grey has-text-centered"},[e("p",[e("b-icon",{attrs:{icon:"emoticon-sad",size:"is-large"}})],1),a._v(" "),e("p",[a._v("Belum ada data sparepart, silahkan tambahkan sparepart terlebih dahulu")])])])]),a._v(" "),e("template",{slot:"footer"},[e("th",{staticStyle:{"text-align":"right"},attrs:{colspan:"6"}},[e("div",{staticClass:"th-wrap is-numeric"},[a._v(a._s(a.price(a.TotalSparepart()))+" ")])])])],2)],1):a._e(),a._v(" "),"SP"!=a.$route.params.transactionType?e("div",[a._m(1),a._v(" "),e("nav",{staticClass:"level"},[e("div",{staticClass:"level-left"},[e("b-field",{attrs:{grouped:"","group-multiline":""}},[e("b-select",{attrs:{disabled:!a.isPaginated},model:{value:a.perPage,callback:function(t){a.perPage=t},expression:"perPage"}},[e("option",{attrs:{value:"10"}},[a._v("10 per page")]),a._v(" "),e("option",{attrs:{value:"20"}},[a._v("20 per page")]),a._v(" "),e("option",{attrs:{value:"50"}},[a._v("50 per page")])])],1)],1),a._v(" "),e("div",{staticClass:"level-right"},[e("b-field",[e("b-input",{attrs:{placeholder:"Search...",type:"search",icon:"magnify"},model:{value:a.search,callback:function(t){a.search=t},expression:"search"}})],1)],1)]),a._v(" "),e("b-table",{attrs:{data:a.detailTransactionsLayananList,paginated:!0,"per-page":a.perPage,"current-page":a.currentPage,loading:a.loadDataLayanan,"pagination-simple":!0,narrowed:!0,"mobile-cards":!0,striped:!0,hoverable:!0},on:{"update:currentPage":function(t){a.currentPage=t},"update:current-page":function(t){a.currentPage=t}},scopedSlots:a._u([{key:"default",fn:function(t){return[e("b-table-column",{attrs:{label:"No.",sortable:""}},[a._v(a._s(t.index+1))]),a._v(" "),e("b-table-column",{attrs:{field:"id",label:"Kode",sortable:""}},[a._v(a._s(t.row.service.id))]),a._v(" "),e("b-table-column",{attrs:{field:"name",label:"Nama",sortable:""}},[a._v(a._s(t.row.service.name))]),a._v(" "),e("b-table-column",{staticStyle:{"text-align":"right"},attrs:{label:"SubTotal",numeric:""}},[a._v(a._s(a.price(t.row.total*t.row.price)))])]}}])},[a._v(" "),e("template",{slot:"empty"},[e("section",{staticClass:"section"},[e("div",{staticClass:"content has-text-grey has-text-centered"},[e("p",[e("b-icon",{attrs:{icon:"emoticon-sad",size:"is-large"}})],1),a._v(" "),e("p",[a._v("Belum ada data layanan, silahkan tambahkan layanan terlebih dahulu")])])])]),a._v(" "),e("template",{slot:"footer"},[e("th",{staticStyle:{"text-align":"right"},attrs:{colspan:"4"}},[e("div",{staticClass:"th-wrap is-numeric"},[a._v(a._s(a.price(a.TotalService()))+" ")])])])],2)],1):a._e(),a._v(" "),e("v-snackbar",{attrs:{color:a.color,"multi-line":!0,timeout:3e3},model:{value:a.snackbar,callback:function(t){a.snackbar=t},expression:"snackbar"}},[a._v("\r\n          "+a._s(a.text)+"\r\n          "),e("v-btn",{attrs:{dark:"",flat:""},on:{click:function(t){a.snackbar=!1}}},[a._v("\r\n            Close\r\n          ")])],1),a._v(" "),e("v-layout",{attrs:{row:"","justify-center":""}},[e("v-dialog",{attrs:{persistent:"","max-width":"600px"},model:{value:a.dialogNotaLunas,callback:function(t){a.dialogNotaLunas=t},expression:"dialogNotaLunas"}},[e("v-form",{ref:"form",attrs:{"lazy-validation":""},model:{value:a.valid,callback:function(t){a.valid=t},expression:"valid"}},[e("v-card",[e("v-card-title",[a._v("\r\n                        Rincian Pembayaran\r\n                    ")]),a._v(" "),e("v-card-text",[e("v-container",{attrs:{"grid-list-md":""}},[e("v-layout",{attrs:{wrap:""}},[e("v-flex",{attrs:{xs12:""}},[e("v-text-field",{attrs:{label:"Total Biaya*",disabled:!0},model:{value:a.displayTotal,callback:function(t){a.displayTotal=t},expression:"displayTotal"}})],1),a._v(" "),e("v-flex",{attrs:{xs12:""}},[e("v-text-field",{attrs:{label:"Diskon*"},on:{input:function(t){a.countDiskon(),a.countChange()}},model:{value:a.editData.diskon,callback:function(t){a.$set(a.editData,"diskon",t)},expression:"editData.diskon"}})],1),a._v(" "),e("v-flex",{attrs:{xs12:""}},[e("v-text-field",{attrs:{label:"Biaya yang harus dibayar*",disabled:!0},model:{value:a.displayBiayaMinDiskon,callback:function(t){a.displayBiayaMinDiskon=t},expression:"displayBiayaMinDiskon"}})],1),a._v(" "),e("v-flex",{attrs:{xs12:""}},[e("v-text-field",{attrs:{label:"Total Bayar*","error-messages":a.changeError},on:{input:function(t){return a.countChange()}},model:{value:a.editData.payment,callback:function(t){a.$set(a.editData,"payment",t)},expression:"editData.payment"}})],1),a._v(" "),e("v-flex",{attrs:{xs12:""}},[e("v-text-field",{attrs:{label:"Kembalian*",disabled:!0},model:{value:a.displayKembalian,callback:function(t){a.displayKembalian=t},expression:"displayKembalian"}})],1)],1)],1),a._v(" "),e("small",[a._v("*Wajib diisi")])],1),a._v(" "),e("v-card-actions",[e("v-spacer"),a._v(" "),e("v-btn",{attrs:{color:"red darken-1",dark:""},on:{click:function(t){t.preventDefault(),a.dialogSPK=!1}}},[a._v("Batal")]),a._v(" "),e("v-btn",{attrs:{color:"green darken-1",dark:"",loading:a.load},on:{click:function(t){return t.preventDefault(),a.cetakNotaLunas()}}},[a._v("Cetak")])],1)],1)],1)],1)],1)],1)])},n=[function(){var a=this,t=a.$createElement,e=a._self._c||t;return e("div",{staticClass:"columns m-t-10"},[e("div",{staticClass:"column"},[e("h1",{staticClass:"title"},[a._v("Sparepart")])])])},function(){var a=this,t=a.$createElement,e=a._self._c||t;return e("div",{staticClass:"columns m-t-10"},[e("div",{staticClass:"column"},[e("h1",{staticClass:"title"},[a._v("Layanan")])])])}],r={render:i,staticRenderFns:n};t.a=r},62:function(a,t,e){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=e(116),n=e(152),r=e(12),s=r(i.a,n.a,!1,null,null,null);t.default=s.exports}});
//# sourceMappingURL=14.d9e24f83f4c8174b5eae.js.map